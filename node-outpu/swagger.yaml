{
  "openapi" : "3.1.0",
  "info" : {
    "title" : "BConnector API",
    "description" : "API oficial da BConnector — Integração entre fornecedores, vendedores e marketplaces.\nEsta documentação cobre os endpoints REST disponíveis para integração com o backend da BConnector.\n",
    "contact" : {
      "name" : "Equipe BConnector",
      "url" : "https://bconnector.com.br",
      "email" : "suporte@bconnector.com.br"
    },
    "version" : "1.0.0"
  },
  "servers" : [ {
    "url" : "https://rejaiayzrixbhoieebpd.supabase.co/functions/v1",
    "description" : "Ambiente de desenvolvimento (Supabase)"
  }, {
    "url" : "https://api.bconnector.com.br/v1",
    "description" : "Ambiente de produção (futuro)"
  } ],
  "tags" : [ {
    "name" : "Produtos",
    "description" : "Endpoints relacionados ao cadastro e gestão de produtos."
  } ],
  "paths" : {
    "/produto-create" : {
      "post" : {
        "tags" : [ "Produtos" ],
        "summary" : "Cria um novo produto",
        "description" : "Cria um produto principal e suas variações vinculadas. Exige autenticação via Bearer token e identificação da empresa e fornecedor.\n",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/ProdutoCreate"
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "Produto criado com sucesso",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ResponseCreate"
                }
              }
            }
          }
        }
      }
    },
    "/produto-update" : {
      "post" : {
        "tags" : [ "Produtos" ],
        "summary" : "Atualiza um produto existente",
        "description" : "Atualiza dados de um produto já existente. Exige o `id_produto` e o `id_empresa` como referência.\n",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/ProdutoUpdate"
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "Produto atualizado com sucesso",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ResponseOK"
                }
              }
            }
          }
        }
      }
    },
    "/produto-list" : {
      "get" : {
        "tags" : [ "Produtos" ],
        "summary" : "Lista produtos",
        "description" : "Retorna a lista de produtos cadastrados, podendo filtrar por fornecedor e empresa. Suporta paginação e filtro por status (`ativo`, `excluido`).\n",
        "parameters" : [ {
          "name" : "id_empresa",
          "in" : "query",
          "required" : false,
          "style" : "form",
          "explode" : true,
          "schema" : {
            "format" : "uuid"
          }
        }, {
          "name" : "id_fornecedor",
          "in" : "query",
          "required" : false,
          "style" : "form",
          "explode" : true,
          "schema" : {
            "format" : "uuid"
          }
        }, {
          "name" : "pagina",
          "in" : "query",
          "required" : false,
          "style" : "form",
          "explode" : true,
          "schema" : {
            "default" : 1
          }
        }, {
          "name" : "limite",
          "in" : "query",
          "required" : false,
          "style" : "form",
          "explode" : true,
          "schema" : {
            "default" : 50
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Lista de produtos",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ProdutoList"
                }
              }
            }
          }
        }
      }
    },
    "/produto-delete" : {
      "post" : {
        "tags" : [ "Produtos" ],
        "summary" : "Exclui um produto (com regras de negócio)",
        "description" : "Exclui um produto de acordo com as permissões do usuário.\n- Admin: pode excluir fisicamente. - Fornecedor: pode excluir apenas se não houver histórico de vendas. - Cliente WL: só pode excluir se o produto não estiver sincronizado.\n",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/ProdutoDelete"
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "Produto excluído com sucesso (ou marcado como excluído)",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ResponseDelete"
                }
              }
            }
          }
        }
      }
    }
  },
  "components" : {
    "schemas" : {
      "ProdutoCreate" : {
        "required" : [ "codigo", "id_empresa", "id_fornecedor", "nome" ],
        "properties" : {
          "id_empresa" : {
            "format" : "uuid"
          },
          "id_fornecedor" : {
            "format" : "uuid"
          },
          "nome" : { },
          "codigo" : { },
          "preco" : { },
          "unidade" : { },
          "marca" : { },
          "descricaoCurta" : { },
          "descricaoComplementar" : { },
          "variacoes" : {
            "items" : {
              "properties" : {
                "codigo" : { },
                "preco" : { },
                "variacao" : { }
              }
            }
          },
          "midia" : {
            "$ref" : "#/components/schemas/ProdutoCreate_midia"
          }
        }
      },
      "ProdutoUpdate" : {
        "allOf" : [ {
          "$ref" : "#/components/schemas/ProdutoCreate"
        }, {
          "required" : [ "id_produto" ],
          "properties" : {
            "id_produto" : {
              "format" : "uuid"
            }
          }
        } ]
      },
      "ProdutoDelete" : {
        "required" : [ "id_empresa", "id_produto", "role_user" ],
        "properties" : {
          "id_produto" : {
            "format" : "uuid"
          },
          "id_empresa" : {
            "format" : "uuid"
          },
          "id_fornecedor" : {
            "format" : "uuid"
          },
          "role_user" : {
            "enum" : [ "admin", "fornecedor", "cliente_wl" ]
          }
        }
      },
      "ProdutoList" : {
        "properties" : {
          "sucesso" : { },
          "total" : { },
          "produtos" : {
            "items" : {
              "properties" : {
                "id" : {
                  "format" : "uuid"
                },
                "nome" : { },
                "preco" : { },
                "ativo" : { },
                "excluido" : { }
              }
            }
          }
        }
      },
      "ResponseOK" : {
        "properties" : {
          "sucesso" : { },
          "mensagem" : { }
        }
      },
      "ResponseCreate" : {
        "properties" : {
          "sucesso" : { },
          "mensagem" : { },
          "id_produto" : { }
        }
      },
      "ResponseDelete" : {
        "properties" : {
          "sucesso" : { },
          "acao" : { },
          "mensagem" : { }
        }
      },
      "ProdutoCreate_midia_imagens" : {
        "properties" : {
          "imagensURL" : {
            "items" : {
              "properties" : {
                "link" : { }
              }
            }
          }
        }
      },
      "ProdutoCreate_midia" : {
        "properties" : {
          "imagens" : {
            "$ref" : "#/components/schemas/ProdutoCreate_midia_imagens"
          }
        }
      }
    }
  }
}